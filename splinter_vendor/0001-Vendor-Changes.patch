From 1739c37fc1218528c0bae3eb97e5a24d362e7001 Mon Sep 17 00:00:00 2001
From: Michael Carroll <michael@openrobotics.org>
Date: Thu, 8 Sep 2022 11:42:23 -0500
Subject: [PATCH] Vendor Changes

Signed-off-by: Michael Carroll <michael@openrobotics.org>
---
 CMakeLists.txt       | 49 +-------------------------------------------
 src/bsplinebasis.cpp |  4 ++--
 2 files changed, 3 insertions(+), 50 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index a1d3154..2ca2742 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -6,7 +6,7 @@
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 project(SPLINTER CXX)
-cmake_minimum_required(VERSION 2.8)
+cmake_minimum_required(VERSION 3.5)
 string(TOLOWER ${PROJECT_NAME} PROJECT_NAME_LOWER)
 
 # Read the SPLINTER version from version file
@@ -219,57 +219,10 @@ add_library(${STATIC_LIBRARY} STATIC ${SRC_LIST})
 add_executable(${TEST} ${TEST_SRC_LIST})
 target_link_libraries(${TEST} ${STATIC_LIBRARY})
 
-# Make the directory structure expected by the MatLab interface
-# License file
-install(
-        FILES ${CMAKE_CURRENT_SOURCE_DIR}/LICENSE
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-matlab/
-)
-# Matlab files (.m)
-install(
-        DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/matlab
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-matlab
-)
-# Version file (used for deducing the name of the binary when loading it)
-file(WRITE ${CMAKE_CURRENT_BINARY_DIR}/splinter-matlab/version ${VERSION})
-install(
-        FILES include/cinterface/cinterface.h
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-matlab/include
-)
-install(
-        TARGETS ${SHARED_LIBRARY}
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-matlab/lib/${OS_STRING}/${ARCH}
-)
-
-# Make the directory structure expected by the Python interface
-install(
-        FILES ${CMAKE_CURRENT_SOURCE_DIR}/LICENSE
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-python/
-)
-# Python files (.py)
-install(
-        DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/python
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-python
-        PATTERN "*.pyc" EXCLUDE
-        PATTERN "__pycache__*" EXCLUDE
-)
-# Version file (used for deducing the name of the binary when loading it)
-file(WRITE ${CMAKE_CURRENT_BINARY_DIR}/splinter-python/version ${VERSION})
-install(
-        FILES include/cinterface/cinterface.h
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-python/include
-)
-install(
-        TARGETS ${SHARED_LIBRARY}
-        DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/splinter-python/lib/${OS_STRING}/${ARCH}
-)
-
 # Install the header files (including Eigen) to the header directory
 install(
     DIRECTORY
     ${CMAKE_CURRENT_SOURCE_DIR}/include/
-    ${EIGEN_DIRECTORY}/Eigen
-    ${EIGEN_DIRECTORY}/unsupported
     DESTINATION ${HEADER_INSTALL_DIRECTORY}/SPLINTER
 )
 # Install the shared library file
diff --git a/src/bsplinebasis.cpp b/src/bsplinebasis.cpp
index c90bbd6..387aa9b 100644
--- a/src/bsplinebasis.cpp
+++ b/src/bsplinebasis.cpp
@@ -119,7 +119,7 @@ SparseMatrix BSplineBasis::evalBasisJacobian(DenseVector &x) const
 
         // Fill out column
         for (int k = 0; k < Ji.outerSize(); ++k)
-        for (SparseMatrix::InnerIterator it(Ji,k); it; ++it)
+        for (SparseVector::InnerIterator it(Ji,k); it; ++it)
         {
             if (it.value() != 0)
                 J.insert(it.row(),i) = it.value();
@@ -218,7 +218,7 @@ SparseMatrix BSplineBasis::evalBasisHessian(DenseVector &x) const
 
             // Fill out column
             for (int k = 0; k < Hi.outerSize(); ++k)
-            for (SparseMatrix::InnerIterator it(Hi,k); it; ++it)
+            for (SparseVector::InnerIterator it(Hi,k); it; ++it)
             {
                 if (it.value() != 0)
                 {
-- 
2.34.1

